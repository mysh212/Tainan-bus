(function(){"use strict";var t={29:function(t,e,s){var i=s(6768),a=s(5130),n=s(4232);const l={key:0,class:"progress"},o={class:"input-field"},c={key:0},r={key:1,class:"btn",href:"#current"},u={class:"container",id:"buses"},d={class:"row"},h={class:"col s12 m4"},v={class:"card white waves-block waves-effect"},m={class:"col s12 m4"},k={class:"card cyan"},f={class:"card-content white-text"},p={class:"col s12 m4"},b={class:"row"},g={class:"col s12 m6 hide-on-med-and-down"},L=["onClick"],w={class:"card-content"},_={class:"right"},y={class:"chip"},x={class:"chip"},C={key:0,class:"material-icons",id:"current"},E={class:"col s12 m6 hide-on-large-only"},I=["onClick"],O={class:"card-content"},X={class:"card-content"},j={class:"chip"},A={class:"chip"},B={class:"right"},F={key:0,class:"material-icons",id:"current"},P={id:"routes",class:"col s12 m6"},S=["onClick"],T={class:"card-content"},N={key:0,class:"right"},Q={key:1,class:"right"},R={class:"fixed-action-btn"},K={key:0,class:"btn-floating blue",href:"#current"};function V(t,e,s,$,V,q){return(0,i.uX)(),(0,i.CE)(i.FK,null,[V.loading?((0,i.uX)(),(0,i.CE)("div",l,e[3]||(e[3]=[(0,i.Lk)("div",{class:"indeterminate"},null,-1)]))):(0,i.Q3)("",!0),(0,i.Lk)("div",o,[(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>V.search.text=t),id:"search"},null,512),[[a.Jo,V.search.text]]),e[4]||(e[4]=(0,i.Lk)("label",{for:"search"}," Search Route ",-1)),V.search.text?((0,i.uX)(),(0,i.CE)("p",c," Searching: "+(0,n.v_)(V.search.text),1)):(0,i.Q3)("",!0)]),V.loc.mmin?((0,i.uX)(),(0,i.CE)("div",r," 距離最近的站牌： "+(0,n.v_)(V.bus?.data[V.loc.mmin]?.name),1)):(0,i.Q3)("",!0),(0,i.Lk)("div",u,[(0,i.Lk)("div",d,[(0,i.Lk)("div",h,[(0,i.Lk)("div",v,[(0,i.Lk)("div",{class:(0,n.C4)(["card-content",""==this.app?"green":""]),onClick:e[1]||(e[1]=t=>{this.app="",q.check(this.bus_number)})},[e[5]||(e[5]=(0,i.Lk)("b",null," From ",-1)),(0,i.Lk)("h3",null,(0,n.v_)(V.bus?.Go),1)],2)])]),(0,i.Lk)("div",m,[(0,i.Lk)("div",k,[(0,i.Lk)("div",f,[e[6]||(e[6]=(0,i.Lk)("b",null," Route ",-1)),(0,i.Lk)("h3",null,(0,n.v_)(V.bus?.name),1)])])]),(0,i.Lk)("div",p,[(0,i.Lk)("div",{class:"card white waves-block waves-effect",onClick:e[2]||(e[2]=t=>{this.app="&goback=1",q.check(this.bus_number)})},[(0,i.Lk)("div",{class:(0,n.C4)(["card-content",""!=this.app?"green":""])},[e[7]||(e[7]=(0,i.Lk)("b",null," To ",-1)),(0,i.Lk)("h3",null,(0,n.v_)(V.bus?.Back),1)],2)])])]),(0,i.Lk)("div",b,[(0,i.Lk)("div",g,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(V.bus?.data,((t,e)=>((0,i.uX)(),(0,i.CE)("div",{key:t},[(0,i.Lk)("div",{class:"card waves-block waves-effect",onClick:e=>q.get_stop(t?.name)},[(0,i.Lk)("div",w,[(0,i.Lk)("b",null,(0,n.v_)(t?.name),1),(0,i.Lk)("b",_,(0,n.v_)(t?.stopStatus),1),(0,i.Lk)("div",y,(0,n.v_)(t?.lat),1),(0,i.Lk)("div",x,(0,n.v_)(t?.lon),1),e==V.loc.mmin?((0,i.uX)(),(0,i.CE)("i",C," check ")):(0,i.Q3)("",!0)])],8,L)])))),128))]),(0,i.Lk)("div",E,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(V.bus?.data,((t,s)=>((0,i.uX)(),(0,i.CE)("div",{key:t},[(0,i.Lk)("div",{class:"card waves-block waves-effect",onClick:e=>q.get_stop(t?.name)},[(0,i.Lk)("div",O,[(0,i.Lk)("b",null,(0,n.v_)(t?.name),1)]),e[8]||(e[8]=(0,i.Lk)("div",{class:"divider"},null,-1)),(0,i.Lk)("div",X,[(0,i.Lk)("div",j,(0,n.v_)(t?.lat),1),(0,i.Lk)("div",A,(0,n.v_)(t?.lon),1),(0,i.Lk)("b",B,(0,n.v_)(t?.stopStatus),1),s==V.loc.mmin?((0,i.uX)(),(0,i.CE)("i",F," check ")):(0,i.Q3)("",!0)])],8,I)])))),128))]),(0,i.Lk)("div",P,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(V.route,(t=>((0,i.uX)(),(0,i.CE)("div",{key:t},[!V.search.text||t?.name.includes(V.search.text)?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"card yellow lighten-5 waves-block waves-effect",onClick:e=>q.check(t?.id)},[(0,i.Lk)("div",T,[(0,i.Lk)("b",null,(0,n.v_)(t?.name),1),t?.time?((0,i.uX)(),(0,i.CE)("b",N,(0,n.v_)(t?.time)+" "+(0,n.v_)(q.isint(t?.time)?"分鐘":""),1)):((0,i.uX)(),(0,i.CE)("b",Q,(0,n.v_)(t?.id),1))])],8,S)):(0,i.Q3)("",!0)])))),128))])])]),e[13]||(e[13]=(0,i.Lk)("div",{id:"modal1",class:"modal"},[(0,i.Lk)("div",{class:"modal-content"},[(0,i.Lk)("h4",null,"Modal Header"),(0,i.Lk)("p",null,"A bunch of text")]),(0,i.Lk)("div",{class:"modal-footer"},[(0,i.Lk)("a",{href:"#!",class:"modal-close waves-effect waves-green btn-flat"},"Agree")])],-1)),(0,i.Lk)("div",R,[e[12]||(e[12]=(0,i.Lk)("a",{class:"btn-floating btn-large red"},[(0,i.Lk)("i",{class:"large material-icons"},"mode_edit")],-1)),(0,i.Lk)("ul",null,[(0,i.Lk)("li",null,[V.loc.mmin?((0,i.uX)(),(0,i.CE)("a",K,e[9]||(e[9]=[(0,i.Lk)("i",{class:"material-icons"},"directions_bus",-1)]))):(0,i.Q3)("",!0)]),e[10]||(e[10]=(0,i.Lk)("li",null,[(0,i.Lk)("a",{class:"btn-floating blue",href:"#buses"},[(0,i.Lk)("i",{class:"material-icons"},"directions_bus")])],-1)),e[11]||(e[11]=(0,i.Lk)("li",null,[(0,i.Lk)("a",{class:"btn-floating green",href:"#routes"},[(0,i.Lk)("i",{class:"material-icons"},"timeline")])],-1))])])],64)}s(4114);var q=s(6587),J=s.n(q),H=s(5741),M=s.n(H),U={name:"App",data(){return{test:"",bus_number:"",bus:null,route:null,app:"",loading:!1,loc:{pos:[-1,-1],mmin:null},search:{text:""}}},mounted(){M().AutoInit(),$.get("https://2384.tainan.gov.tw/NewTNBusAPI_V2/API/PathListV2.ashx",(t=>{this.route=t})),navigator.geolocation.getCurrentPosition((t=>{M().toast({html:'<i class = "material-icons"> check </i>'+[t.coords.latitude,t.coords.longitude],classes:"green rounded"}),this.pos=[t.coords.latitude,t.coords.longitude]}),(t=>{M().toast({html:"ERROR while getting location.",classes:"red rounded"})}))},methods:{check(t){this.loading=!0,location.href="#buses",this.bus_number=t;var e="https://2384.tainan.gov.tw/IMP/jsp/rwd_api/ajax_routeinfo.jsp?id="+t+"&lang=cht"+this.app;$.get(e,(t=>{this.test=t,t["result"]?M().toast({html:"Bus status updated.",classes:"rounded green"}):M().toast({html:JSON.stringify(t),classes:"rounded red"}),this.bus=t,this.update_location(),this.loading=!1}))},get_stop(t){this.loading=!0,location.href="#routes";var e="https://2384.tainan.gov.tw/NewTNBusAPI_V2/API/CrossRoutesV2.ashx";$.post(e,{stopnamecht:t},(t=>{for(var e of(this.route=[],t[0]["info"]))this.route.push({name:e.RouteName,id:e.RouteID,time:e.Time});this.route.sort(((t,e)=>{var s=t?.time,i=e?.time;return"即將進站"==t?.time?s="-10000":this.isint(t?.time)||(s="10000"),"即將進站"==e?.time?i="-10000":this.isint(e?.time)||(i="10000"),parseInt(s)-parseInt(i)})),this.loading=!1}))},update_location(){if(null!=this.bus&&this.loc.pos!=[-1,-1]){var t,e,s=(t,e)=>(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]);t=1e6,e=-1;var i=0;for(var a of this.bus?.data){var n=s(this.loc.pos,[a.lat,a.lon]);n<t&&(t=n,e=i),i++}this.loc.mmin=e,location.href="#current"}},isint(t){return/^\d+$/.test(t)}}},Y=s(1241);const D=(0,Y.A)(U,[["render",V]]);var G=D;function z(t,e,s,a,n,l){return e[0]||(e[0]=(0,i.Fv)('<nav><div class="nav-wrapper grey"><ul><a><i class="material-icons sidenav-trigger" data-target="slide-out"> menu </i></a><a href="/" class="brand-logo"><i class="material-icons hide-on-med-and-down" style="padding-left:10px;">cloud</i> ysh&#39;s toolbox</a></ul><ul id="nav-mobile" class="right hide-on-med-and-down"><li><a href="tainan_bus.html">Bus in <b class="orange-text">Tainan</b></a></li><li><a href="ncku_bus.html">Bus in <b class="red-text">NCKU</b></a></li></ul></div></nav><ul id="slide-out" class="sidenav"><h5 style="padding-left:25px;"> ysh&#39;s toolbox </h5><li><div class="divider"></div></li><li><a class="subheader">Bus</a></li><li><a class="waves-effect" href="tainan_bus.html">Bus in <b class="orange-text">Tainan</b></a></li><li><a class="waves-effect" href="ncku_bus.html">Bus in <b class="red-text">NCKU</b></a></li></ul>',2))}var W={name:"nav",data(){return{id:0,user:void 0}},mounted(){M().AutoInit(),this.id=localStorage.getItem("id"),this.id||localStorage.setItem("id","test"),$.post("//api.citrc.tw/wbox/whoami",{id:this.id},(t=>{t=JSON.parse(t),t["ok"]?this.user=t["data"]:(localStorage.removeItem("id"),this.id=void 0),-1!=location.href.indexOf("?login")&&M().toast({html:"<i class='material-icons' style='padding-right: 10px;'> check_circle </i> Hello, "+this.user,classes:"green rounded"})})),-1!=location.href.indexOf("?logout")&&M().toast({html:"<i class='material-icons' style='padding-right: 10px;'> exit_to_app </i> Logged out successfully",classes:"cyan rounded"})},methods:{logout(){$.post("//api.citrc.tw/wbox/logout",{id:this.id},(t=>{localStorage.removeItem("id"),location.href="/?logout"}))},upload(){void 0==this.user?M().toast({html:"<i class='material-icons' style='padding-right: 10px'> block </i> You haven't login",classes:"rounded cyan"}):location.href="upload.html"}}};const Z=(0,Y.A)(W,[["render",z]]);var tt=Z;s(8055);(0,i.bF)("script",{src:"https://code.jquery.com/jquery-3.7.1.min.js",integrity:"sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=",crossorigin:"anonymous"},null),Object.assign(window,{$:J(),jQuery:J()}),(0,a.Ef)(G).mount("#app"),(0,a.Ef)(tt).mount("#nav")}},e={};function s(i){var a=e[i];if(void 0!==a)return a.exports;var n=e[i]={exports:{}};return t[i].call(n.exports,n,n.exports,s),n.exports}s.m=t,function(){var t=[];s.O=function(e,i,a,n){if(!i){var l=1/0;for(u=0;u<t.length;u++){i=t[u][0],a=t[u][1],n=t[u][2];for(var o=!0,c=0;c<i.length;c++)(!1&n||l>=n)&&Object.keys(s.O).every((function(t){return s.O[t](i[c])}))?i.splice(c--,1):(o=!1,n<l&&(l=n));if(o){t.splice(u--,1);var r=a();void 0!==r&&(e=r)}}return e}n=n||0;for(var u=t.length;u>0&&t[u-1][2]>n;u--)t[u]=t[u-1];t[u]=[i,a,n]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={57:0};s.O.j=function(e){return 0===t[e]};var e=function(e,i){var a,n,l=i[0],o=i[1],c=i[2],r=0;if(l.some((function(e){return 0!==t[e]}))){for(a in o)s.o(o,a)&&(s.m[a]=o[a]);if(c)var u=c(s)}for(e&&e(i);r<l.length;r++)n=l[r],s.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return s.O(u)},i=self["webpackChunkvue"]=self["webpackChunkvue"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=s.O(void 0,[504],(function(){return s(29)}));i=s.O(i)})();
//# sourceMappingURL=index.2fd5b99e.js.map