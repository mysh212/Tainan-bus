(function(){"use strict";var t={9220:function(t,s,e){var i=e(6768),a=e(5130),n=e(4232);const l={key:0,class:"progress"},o={class:"input-field"},c={key:0},r={key:1,class:"btn",href:"#current"},u={class:"container",id:"buses"},d={class:"row"},h={class:"col s12 m4"},v={class:"card white waves-block waves-effect"},m={class:"col s12 m4"},k={class:"card cyan"},f={class:"card-content white-text"},p={class:"col s12 m4"},b={class:"row"},g={class:"col s12 m6 hide-on-med-and-down"},L=["onClick"],w={class:"card-content"},_={class:"right"},y={class:"chip"},x={class:"chip"},C={key:0,class:"chip"},E={key:1,class:"material-icons",id:"current"},I={class:"col s12 m6 hide-on-large-only"},O=["onClick"],X={class:"card-content"},j={class:"card-content"},A={class:"chip"},B={class:"chip"},F={key:0,class:"chip"},P={class:"right"},Q={key:1,class:"material-icons",id:"current"},S={id:"routes",class:"col s12 m6"},T=["onClick"],N={class:"card-content"},R={key:0,class:"right"},K={key:1,class:"right"},V={class:"fixed-action-btn"},q={key:0,class:"btn-floating blue",href:"#current"};function J(t,s,e,$,J,H){return(0,i.uX)(),(0,i.CE)(i.FK,null,[J.loading?((0,i.uX)(),(0,i.CE)("div",l,s[3]||(s[3]=[(0,i.Lk)("div",{class:"indeterminate"},null,-1)]))):(0,i.Q3)("",!0),(0,i.Lk)("div",o,[(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=t=>J.search.text=t),id:"search"},null,512),[[a.Jo,J.search.text]]),s[4]||(s[4]=(0,i.Lk)("label",{for:"search"}," Search Route ",-1)),J.search.text?((0,i.uX)(),(0,i.CE)("p",c," Searching: "+(0,n.v_)(J.search.text),1)):(0,i.Q3)("",!0)]),J.loc.mmin?((0,i.uX)(),(0,i.CE)("div",r," 距離最近的站牌： "+(0,n.v_)(J.bus?.data[J.loc.mmin]?.name),1)):(0,i.Q3)("",!0),(0,i.Lk)("div",u,[(0,i.Lk)("div",d,[(0,i.Lk)("div",h,[(0,i.Lk)("div",v,[(0,i.Lk)("div",{class:(0,n.C4)(["card-content",""==this.app?"green":""]),onClick:s[1]||(s[1]=t=>{this.app="",H.check(this.bus_number)})},[s[5]||(s[5]=(0,i.Lk)("b",null," From ",-1)),(0,i.Lk)("h3",null,(0,n.v_)(J.bus?.Go),1)],2)])]),(0,i.Lk)("div",m,[(0,i.Lk)("div",k,[(0,i.Lk)("div",f,[s[6]||(s[6]=(0,i.Lk)("b",null," Route ",-1)),(0,i.Lk)("h3",null,(0,n.v_)(J.bus?.name),1)])])]),(0,i.Lk)("div",p,[(0,i.Lk)("div",{class:"card white waves-block waves-effect",onClick:s[2]||(s[2]=t=>{this.app="&goback=1",H.check(this.bus_number)})},[(0,i.Lk)("div",{class:(0,n.C4)(["card-content",""!=this.app?"green":""])},[s[7]||(s[7]=(0,i.Lk)("b",null," To ",-1)),(0,i.Lk)("h3",null,(0,n.v_)(J.bus?.Back),1)],2)])])]),(0,i.Lk)("div",b,[(0,i.Lk)("div",g,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(J.bus?.data,((t,e)=>((0,i.uX)(),(0,i.CE)("div",{key:t},[(0,i.Lk)("div",{class:"card waves-block waves-effect",onClick:s=>H.get_stop(t?.name)},[(0,i.Lk)("div",w,[(0,i.Lk)("b",null,(0,n.v_)(t?.name),1),(0,i.Lk)("b",_,(0,n.v_)(t?.stopStatus),1),(0,i.Lk)("div",y,(0,n.v_)(t?.lat),1),(0,i.Lk)("div",x,(0,n.v_)(t?.lon),1),t?.dt?((0,i.uX)(),(0,i.CE)("div",C,[s[8]||(s[8]=(0,i.Lk)("i",{class:"material-icons"}," location_on ",-1)),(0,i.eW)(" "+(0,n.v_)(t?.dt),1)])):(0,i.Q3)("",!0),e==J.loc.mmin?((0,i.uX)(),(0,i.CE)("i",E," check ")):(0,i.Q3)("",!0)])],8,L)])))),128))]),(0,i.Lk)("div",I,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(J.bus?.data,((t,e)=>((0,i.uX)(),(0,i.CE)("div",{key:t},[(0,i.Lk)("div",{class:"card waves-block waves-effect",onClick:s=>H.get_stop(t?.name)},[(0,i.Lk)("div",X,[(0,i.Lk)("b",null,(0,n.v_)(t?.name),1)]),s[10]||(s[10]=(0,i.Lk)("div",{class:"divider"},null,-1)),(0,i.Lk)("div",j,[(0,i.Lk)("div",A,(0,n.v_)(t?.lat),1),(0,i.Lk)("div",B,(0,n.v_)(t?.lon),1),t?.dt?((0,i.uX)(),(0,i.CE)("div",F,[s[9]||(s[9]=(0,i.Lk)("i",{class:"material-icons"}," location_on ",-1)),(0,i.eW)(" "+(0,n.v_)(t?.dt),1)])):(0,i.Q3)("",!0),(0,i.Lk)("b",P,(0,n.v_)(t?.stopStatus),1),e==J.loc.mmin?((0,i.uX)(),(0,i.CE)("i",Q," check ")):(0,i.Q3)("",!0)])],8,O)])))),128))]),(0,i.Lk)("div",S,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(J.route,(t=>((0,i.uX)(),(0,i.CE)("div",{key:t},[!J.search.text||t?.name.includes(J.search.text)?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"card yellow lighten-5 waves-block waves-effect",onClick:s=>H.check(t?.id)},[(0,i.Lk)("div",N,[(0,i.Lk)("b",null,(0,n.v_)(t?.name),1),t?.time?((0,i.uX)(),(0,i.CE)("b",R,(0,n.v_)(t?.time)+" "+(0,n.v_)(H.isint(t?.time)?"分鐘":""),1)):((0,i.uX)(),(0,i.CE)("b",K,(0,n.v_)(t?.id),1))])],8,T)):(0,i.Q3)("",!0)])))),128))])])]),s[15]||(s[15]=(0,i.Lk)("div",{id:"modal1",class:"modal"},[(0,i.Lk)("div",{class:"modal-content"},[(0,i.Lk)("h4",null,"Modal Header"),(0,i.Lk)("p",null,"A bunch of text")]),(0,i.Lk)("div",{class:"modal-footer"},[(0,i.Lk)("a",{href:"#!",class:"modal-close waves-effect waves-green btn-flat"},"Agree")])],-1)),(0,i.Lk)("div",V,[s[14]||(s[14]=(0,i.Lk)("a",{class:"btn-floating btn-large red"},[(0,i.Lk)("i",{class:"large material-icons"},"mode_edit")],-1)),(0,i.Lk)("ul",null,[(0,i.Lk)("li",null,[J.loc.mmin?((0,i.uX)(),(0,i.CE)("a",q,s[11]||(s[11]=[(0,i.Lk)("i",{class:"material-icons"},"directions_bus",-1)]))):(0,i.Q3)("",!0)]),s[12]||(s[12]=(0,i.Lk)("li",null,[(0,i.Lk)("a",{class:"btn-floating blue",href:"#buses"},[(0,i.Lk)("i",{class:"material-icons"},"directions_bus")])],-1)),s[13]||(s[13]=(0,i.Lk)("li",null,[(0,i.Lk)("a",{class:"btn-floating green",href:"#routes"},[(0,i.Lk)("i",{class:"material-icons"},"timeline")])],-1))])])],64)}e(4114);var H=e(6587),M=e.n(H),U=e(5741),W=e.n(U),Y={name:"App",data(){return{test:"",bus_number:"",bus:null,route:null,app:"",loading:!1,loc:{pos:[-1,-1],mmin:null},search:{text:""}}},mounted(){W().AutoInit(),$.get("https://2384.tainan.gov.tw/NewTNBusAPI_V2/API/PathListV2.ashx",(t=>{this.route=t})),navigator.geolocation.getCurrentPosition((t=>{W().toast({html:'<i class = "material-icons"> check </i>'+[t.coords.latitude,t.coords.longitude],classes:"green rounded"}),this.loc.pos=[t.coords.latitude,t.coords.longitude],this.update_location()}),(t=>{W().toast({html:"ERROR while getting location.",classes:"red rounded"})}))},methods:{check(t){this.loading=!0,location.href="#buses",this.bus_number=t;var s="https://2384.tainan.gov.tw/IMP/jsp/rwd_api/ajax_routeinfo.jsp?id="+t+"&lang=cht"+this.app;$.get(s,(t=>{this.test=t,t["result"]?W().toast({html:"Bus status updated.",classes:"rounded green"}):W().toast({html:JSON.stringify(t),classes:"rounded red"}),this.bus=t,this.update_location(),this.loading=!1}))},get_stop(t){this.loading=!0,location.href="#routes";var s="https://2384.tainan.gov.tw/NewTNBusAPI_V2/API/CrossRoutesV2.ashx";$.post(s,{stopnamecht:t},(t=>{for(var s of(this.route=[],t[0]["info"]))this.route.push({name:s.RouteName,id:s.RouteID,time:s.Time});this.route.sort(((t,s)=>{var e=t?.time,i=s?.time;return"即將進站"==t?.time?e="-10000":this.isint(t?.time)||(e="10000"),"即將進站"==s?.time?i="-10000":this.isint(s?.time)||(i="10000"),parseInt(e)-parseInt(i)})),this.loading=!1}))},update_location(){if(null!=this.bus&&(-1!=this.loc.pos[0]||-1!=this.loc.pos[1])){var t,s,e=(t,s)=>(t[0]-s[0])*(t[0]-s[0])+(t[1]-s[1])*(t[1]-s[1]);t=1e6,s=-1;var i=0;for(var a of this.bus?.data){var n=e(this.loc.pos,[a.lat,a.lon]);a["dt"]=e(this.loc.pos,[a.lat,a.lon]),n<t&&(t=n,s=i),i++}this.loc.mmin=s,location.href="#current"}},isint(t){return/^\d+$/.test(t)}}},D=e(1241);const G=(0,D.A)(Y,[["render",J]]);var z=G;function Z(t,s,e,a,n,l){return s[0]||(s[0]=(0,i.Fv)('<nav><div class="nav-wrapper grey"><ul><a><i class="material-icons sidenav-trigger" data-target="slide-out"> menu </i></a><a href="/" class="brand-logo"><i class="material-icons hide-on-med-and-down" style="padding-left:10px;">cloud</i> ysh&#39;s toolbox</a></ul><ul id="nav-mobile" class="right hide-on-med-and-down"><li><a href="tainan_bus.html">Bus in <b class="orange-text">Tainan</b></a></li><li><a href="ncku_bus.html">Bus in <b class="red-text">NCKU</b></a></li></ul></div></nav><ul id="slide-out" class="sidenav"><h5 style="padding-left:25px;"> ysh&#39;s toolbox </h5><li><div class="divider"></div></li><li><a class="subheader">Bus</a></li><li><a class="waves-effect" href="tainan_bus.html">Bus in <b class="orange-text">Tainan</b></a></li><li><a class="waves-effect" href="ncku_bus.html">Bus in <b class="red-text">NCKU</b></a></li></ul>',2))}var tt={name:"nav",data(){return{id:0,user:void 0}},mounted(){W().AutoInit(),this.id=localStorage.getItem("id"),this.id||localStorage.setItem("id","test"),$.post("//api.citrc.tw/wbox/whoami",{id:this.id},(t=>{t=JSON.parse(t),t["ok"]?this.user=t["data"]:(localStorage.removeItem("id"),this.id=void 0),-1!=location.href.indexOf("?login")&&W().toast({html:"<i class='material-icons' style='padding-right: 10px;'> check_circle </i> Hello, "+this.user,classes:"green rounded"})})),-1!=location.href.indexOf("?logout")&&W().toast({html:"<i class='material-icons' style='padding-right: 10px;'> exit_to_app </i> Logged out successfully",classes:"cyan rounded"})},methods:{logout(){$.post("//api.citrc.tw/wbox/logout",{id:this.id},(t=>{localStorage.removeItem("id"),location.href="/?logout"}))},upload(){void 0==this.user?W().toast({html:"<i class='material-icons' style='padding-right: 10px'> block </i> You haven't login",classes:"rounded cyan"}):location.href="upload.html"}}};const st=(0,D.A)(tt,[["render",Z]]);var et=st;e(8055);(0,i.bF)("script",{src:"https://code.jquery.com/jquery-3.7.1.min.js",integrity:"sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=",crossorigin:"anonymous"},null),Object.assign(window,{$:M(),jQuery:M()}),(0,a.Ef)(z).mount("#app"),(0,a.Ef)(et).mount("#nav")}},s={};function e(i){var a=s[i];if(void 0!==a)return a.exports;var n=s[i]={exports:{}};return t[i].call(n.exports,n,n.exports,e),n.exports}e.m=t,function(){var t=[];e.O=function(s,i,a,n){if(!i){var l=1/0;for(u=0;u<t.length;u++){i=t[u][0],a=t[u][1],n=t[u][2];for(var o=!0,c=0;c<i.length;c++)(!1&n||l>=n)&&Object.keys(e.O).every((function(t){return e.O[t](i[c])}))?i.splice(c--,1):(o=!1,n<l&&(l=n));if(o){t.splice(u--,1);var r=a();void 0!==r&&(s=r)}}return s}n=n||0;for(var u=t.length;u>0&&t[u-1][2]>n;u--)t[u]=t[u-1];t[u]=[i,a,n]}}(),function(){e.n=function(t){var s=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(s,{a:s}),s}}(),function(){e.d=function(t,s){for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){e.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)}}(),function(){var t={57:0};e.O.j=function(s){return 0===t[s]};var s=function(s,i){var a,n,l=i[0],o=i[1],c=i[2],r=0;if(l.some((function(s){return 0!==t[s]}))){for(a in o)e.o(o,a)&&(e.m[a]=o[a]);if(c)var u=c(e)}for(s&&s(i);r<l.length;r++)n=l[r],e.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return e.O(u)},i=self["webpackChunkvue"]=self["webpackChunkvue"]||[];i.forEach(s.bind(null,0)),i.push=s.bind(null,i.push.bind(i))}();var i=e.O(void 0,[504],(function(){return e(9220)}));i=e.O(i)})();
//# sourceMappingURL=index.8614261f.js.map